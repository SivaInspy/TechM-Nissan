sqoop import --connect jdbc:oracle:thin:@10.78.79.27:55298/OPDBEFLO --query "select INCDNT_IVSTGN_RPT_FORM_NM,TRD_CD,TRD_CD_DS,CAST('x987731' as VARCHAR(10)) as CRTE_USR_ID,CURRENT_TIMESTAMP as CRTE_TS,CMPST_KY,UPDT_TS from (select iif.INCDNT_IVSTGN_RPT_FORM_NM || trd.TRD_CD as CMPST_KY,
iif.INCDNT_IVSTGN_RPT_FORM_NM,
 trd.TRD_CD,
 trd.TRD_CD_DS,
 iif.crte_ts AS UPDT_TS
from
(select iif.INCDNT_DM_KY,
iif.INCDNT_TYP_DM_KY,
iif.TRD_DM_KY,
iif.TRNSCN_DT_KY,
iif.TRD_EFCTV_DT_KY,
iif.VHCL_ISPCTN_DT_KY,
iif.VHCL_DM_KY,
iif.VHCL_MDL_DM_KY,
iif.CLMNT_ST_DM_KY,
iif.CLMNT_CNTRY_DM_KY,
iif.ESTMTD_SPD_TX,
iif.OTHR_VHCL_INVLV_IN,
iif.PRPRTY_DS,
iif.ADTNL_OBSVTN_TX,
iif.VHCL_ADVNCD_TCHLGY_IN,
iif.ARBG_OBSVTN_TX,
iif.ALGTN_CMPNT_LVL_1_NM,
iif.ALGTN_CMPNT_LVL_2_NM,
iif.ALGTN_CMPNT_LVL_3_NM,
iif.BRAK_SPLMNT_IN,
iif.SLSFRC_CASE_ID,
iif.CTR_REAR_VHCL_OCPNT_INJRY_IN,
iif.INCDNT_OCRNC_TS,
iif.VHCL_DRVR_INJRY_DS,
iif.CTR_REAR_VHCL_OCPNT_INJRY_DS,
iif.LFT_REAR_VHCL_OCPNT_INJRY_DS,
iif.OTHR_VHCL_OCPNT_INJRY_DS,
iif.RGHT_REAR_VHCL_OCPNT_INJRY_DS,
iif.ALGTN_DTL_DS,
iif.PRDT_SFTY_RSPNS_DS,
iif.DRVR_ARBG_STS_NM,
iif.VHCL_DRVR_INJRY_IN,
iif.PWRTRN_OBSVTN_TX,
iif.EXTR_BDY_INCDNT_TX,
iif.INCDNT_IVSTGN_RPT_FORM_ID,
iif.RMVD_ALGD_DFCTV_PRT_TX,
iif.INTRR_INFRMN_TX,
iif.LFT_REAR_ARBG_STS_NM,
iif.LFT_REAR_VHCL_OCPNT_INJRY_IN,
iif.VHCL_PRKD_DRTN_TX,
iif.INCDNT_LCTN_TX,
iif.MN_ALGTN_NM,
iif.ISPCTN_MLG_NB,
iif.PRDT_SFTY_MNTR_IN,
iif.INCDNT_IVSTGN_RPT_FORM_NM,
iif.PRPRTY_DMG_DS,
iif.OTHR_VHCL_DMG_DS,
iif.PRSN_INVLVD_NB,
iif.OTHR_SPLMNT_RPT_NM,
iif.ADTNL_VHCL_INFRMN_TX,
iif.OTHR_VHCL_OCPNT_INJRY_IN,
iif.OTHR_ARBG_STS_NM,
iif.OTHR_VHCL_TYP_TX,
iif.VHCL_CRNT_LCTN_TX,
iif.INCDNT_SHRT_DS,
iif.PRDT_SFTY_RSPNS_TX,
iif.RSTRNT_SYSTM_SPLMNT_RPT_IN,
iif.RGHT_FRNT_VHCL_OCPNT_INJRY_DS,
iif.RGHT_FRNT_ARBG_STS_NM,
iif.RGHT_FRNT_VHCL_OCPNT_INJRY_IN,
iif.RGHT_REAR_ARBG_STS_NM,
iif.RGHT_REAR_VHCL_OCPNT_INJRY_IN,
iif.SEAT_RSTRNT_OBSVTN_TX,
iif.SCNDRY_ALGTN_NM,
iif.STERNG_SPLMNT_RPT_IN,
iif.THRML_SPLMNT_RPT_IN,
iif.TRNMSN_SPLMNT_RPT_IN,
iif.UINTD_ACLRT_SPLMNT_RPT_IN,
iif.UNDR_CARG_OBSVTN_TX,
iif.ESTMTD_VHCL_SPD_TX,
iif.IVSTGN_VIN_ID,
iif.WTHR_CNDTN_TX,
iif.INCDNT_IVSTGN_RPT_PDF_URL_TX,
iif.INCDNT_DTL_DS,
iif.CSTMR_RQST_TX,
iif.INCDNT_VHCL_MDL_YR_NB,
iif.INCDNT_VHCL_NMC_MDL_CD,
iif.INCDNT_VHCL_MK_NM,
iif.ATCHMT_IN,
iif.CNSMR_AFR_INSTNC_CN,
iif.CRTE_TS,
iif.CRTE_USR_ID
from
(select c.iNCDNT_DM_KY, c.INCDNT_TYP_DM_KY, max(c.TRNSCN_DT_KY) as iir_tns_dt
from (
    SELECT D.INCDNT_DM_KY, D.INCDNT_TYP_DM_KY, D.TRNSCN_DT_KY
    FROM BID_LGL_IIR.INCDNT_IVSTGN_FC D
    ORDER BY D.TRNSCN_DT_KY DESC ) c
group by c.iNCDNT_DM_KY, c.INCDNT_TYP_DM_KY) list,
BID_LGL_IIR.INCDNT_IVSTGN_FC iif
where list.INCDNT_DM_KY = iif.INCDNT_DM_KY
and list.INCDNT_TYP_DM_KY = iif.INCDNT_TYP_DM_KY
and list.iir_TNS_DT = iif.TRNSCN_DT_KY) iif
left outer join BID_TRD.TRD_DM trd on trd.TRD_DM_KY = iif.TRD_DM_KY) WHERE \$CONDITIONS" --target-dir hdfs://bdedev/data/lgl_iir/raw/incdnt_ivstgn_trd_raw --fields-terminated-by '\001' --null-string '' --null-non-string '' --escaped-by '\\' --check-column UPDT_TS --incremental 'lastmodified' --hive-drop-import-delims --merge-key INCDNT_IVSTGN_RPT_FORM_NM --last-value '0001-01-01 00:00:00.000' --username 'BIDBATCH' --password 'nissan' -m 1
